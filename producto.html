<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Center Hogar Quilmes</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" href="images/logo.webp" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="index.html">
                        <img src="images/logo_trans.png" alt="Center Hogar Quilmes" class="logo-img">
                    </a>
                </div>
                <div class="header-actions">
                    <button class="menu-toggle" aria-label="Abrir menú de navegación">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </button>
                </div>
                <div class="header-contact">
                    <div class="contact-item">
                        <p><a href="https://api.whatsapp.com/send?phone=5491131680489&text=Hola,%20tengo%20una%20consulta" target="_blank">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="contact-icon">
                                <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
                            </svg>
                            11 3168-0489
                        </a></p>
                </div>
                <div class="contact-item">
                    <p><a href="https://maps.app.goo.gl/MGt4KohJ75XAGDWn8" target="_blank">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="contact-icon">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                        Rivadavia 220
                        </a></p>
                </div>
                
        </div>
    </div>
    
            <div class="search-bar">
                <div class="search-bar-input-container">
                    <input type="text" placeholder="Buscar productos..." id="searchInput" autocomplete="off">
                    <button class="search-btn">
                        <img src="images/lupa.png" alt="Buscar" class="search-icon">
                    </button>
                </div>
                <div class="suggestions" id="suggestions" style="display: none;"></div>
            </div>
            <nav class="nav-menu" id="nav-menu">
    <ul>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Cocinas y anafes">Cocinas y<br>anafes</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Cocinas y anafes&subcategoria=Cocinas">Cocinas</a></li>
                <li><a href="categoria.html?nombre=Cocinas y anafes&subcategoria=Anafes">Anafes</a></li>
            </ul>
        </li>
        <li><a href="categoria.html?nombre=Heladeras">Heladeras</a></li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Tv y audio">Tv y Audio</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Tv y audio&subcategoria=Tv">Tv</a></li>
                <li><a href="categoria.html?nombre=Tv y audio&subcategoria=Audio">Audio</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Tecnologia">Tecnología</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Tecnologia&subcategoria=Celulares">Celulares</a></li>
                <li><a href="categoria.html?nombre=Tecnologia&subcategoria=Tablets">Tablets</a></li>
                <li><a href="categoria.html?nombre=Tecnologia&subcategoria=Notebooks">Notebooks</a></li>
                <li><a href="categoria.html?nombre=Tecnologia&subcategoria=Impresoras">Impresoras</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Climatizacion">Climatización</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Calefaccion electrica">Calefacción eléctrica</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Calefaccion a gas">Calefacción a gas</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Ventilacion">Ventilación</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Aires acondicionados">Aires Acondicionados</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Hornos, microondas y freidoras">Hornos, Microondas<br>y freidoras</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Hornos">Hornos</a></li>
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Microondas">Microondas</a></li>
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Freidoras">Freidoras</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Lavado">Lavado</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Lavarropas">Lavarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Lavasecarropas">Lavasecarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Secarropas">Secarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Planchas">Planchas</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Termotanques y calefones">Termotanques<br>y calefones</a>
            <ul class="submenu">
                
                <li><a href="categoria.html?nombre=Termotanques y calefones&subcategoria=Termotanques">Termotanques</a></li>
                <li><a href="categoria.html?nombre=Termotanques y calefones&subcategoria=Calefones">Calefones</a></li>
            </ul>
        </li><li class="has-submenu">
            <a href="categoria.html?nombre=Pequeños">Pequeños<br>electrodomésticos</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Pequeños&subcategoria=batidoras">batidoras</a></li>
                <li><a href="categoria.html?nombre=Pequeños&subcategoria=Licuadoras">Licuadoras</a></li>
                <li><a href="categoria.html?nombre=Pequeños&subcategoria=Multiprocesadoras">Multiprocesadoras</a></li>
                <li><a href="categoria.html?nombre=Pequeños&subcategoria=Mixers">Mixers</a></li>
                <li><a href="categoria.html?nombre=Pequeños&subcategoria=pavas electricas">pavas electricas</a></li>
                <li><a href="categoria.html?nombre=Pequeños&subcategoria=Cafeteras">Cafeteras</a></li>
                <li><a href="categoria.html?nombre=Pequeños&subcategoria=Tostadoras">Tostadoras</a></li>
                <li><a href="categoria.html?nombre=Pequeños&subcategoria=Sandwicheras">Sandwicheras</a></li>
                <li><a href="categoria.html?nombre=Pequeños&subCategoria=Exprimidores y jugueras">Exprimidores y Jugueras</a></li>
                <li><a href="categoria.html?nombre=Pequeños&subcategoria=Picadoras">Picadoras</a></li>
                <li><a href="categoria.html?nombre=Pequeños&subcategoria=Aspiradoras">Aspiradoras</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Cuidado personal">Cuidado Personal</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Planchas de pelo">Planchas de Pelo</a></li>
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Secadores de pelo">Secadores de Pelo</a></li>
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Cortadoras de pelo y barba">Cortadoras de Pelo y Barba</a></li>
            </ul>
        </li>
    </ul>
</nav>
        </div>
    </header>
    <!-- Product Details -->
    <main class="container product-page">
        <!-- Modal para ampliación de imágenes -->
        <div class="image-modal" id="image-modal" style="display: none;">
            <!-- (Tu modal sigue igual) -->
        </div>
        <div class="product-main">
            <div class="image-container">
                <div class="product-images">
                    <div class="main-image-wrapper">
                        <img id="main-image" src="" alt="Producto" class="main-image">
                        <button class="carousel-btn prev">❮</button>
                        <button class="carousel-btn next">❯</button>
                    </div>
                    <div class="thumbnail-gallery" id="thumbnail-gallery"></div>
                </div>
            </div>
            <div class="info-container">
                <div class="product-info">
                    <h1 id="product-name">Nombre del producto</h1>
                    <p class="stock">Stock disponible</p>
                    <a id="whatsapp-contado" href="#" class="contado-btn" target="_blank">Consultar</a>
                    <a id="whatsapp-consulta" href="#" class="consulta-btn" target="_blank">DESCUENTOS AL CONTADO</a>
                    <div class="shipping">
                        <p>Consultá costos de envio</p>
                        <p>Normalmente se entrega de un dia para el otro</p>
                    </div>
                    <div class="product-description">
                        <h2>Descripción</h2>
                        <p id="product-description">Descripción del producto.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="product-features">
            <h2>Características del producto</h2>
            <ul id="product-features"></ul>
        </div>
    </main>

   <!-- Footer -->
    <footer class="footer">
    <div class="container">
        <p>© 2025 Center Hogar Quilmes. Todos los derechos reservados.</p>
        <ul>
            <li><a href="terminos.html">Términos y condiciones</a></li>
            <li><a href="contacto.html">Contacto</a></li>
            <li><a href="privacidad.html">Privacidad</a></li>
            <li><a href="garantia.html">Políticas de garantías</a></li>
        </ul>
    </div>
    </footer>

    <!-- Scroll to top -->
    <button class="scroll-to-top" title="Volver arriba">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 19V5"></path>
            <path d="M5 12l7-7 7 7"></path>
        </svg>
    </button>

    <!-- Carga de datos -->
    <script src="precios.js"></script>
    <script src="productos.js"></script>
    <script src="scripts.js"></script>

    <!-- Script personalizado para mostrar precios y stock -->
    <script>
    document.addEventListener('DOMContentLoaded', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const nombre = urlParams.get('nombre') ? decodeURIComponent(urlParams.get('nombre')) : '';
    const imagen = urlParams.get('imagen') ? decodeURIComponent(urlParams.get('imagen')) : '';
    const imagenes = urlParams.get('imagenes') ? decodeURIComponent(urlParams.get('imagenes')).split(',').filter(i => i) : [];
    const descripcion = urlParams.get('descripcion') ? decodeURIComponent(urlParams.get('descripcion')) : '';
    const caracteristicas = urlParams.get('caracteristicas') ? decodeURIComponent(urlParams.get('caracteristicas')).split(',').filter(c => c) : [];
    const codigoParam = urlParams.get('codigo');

    const producto = productos.find(p => p.nombre === nombre) || productos.find(p => p.codigo === codigoParam);
    const codigo = codigoParam || (producto ? producto.codigo : '');

    if (!codigo) {
        alert("No se pudo obtener el código del producto.");
        return;
    }

    const datos = precios[codigo] || { precio_tarjeta: 'No disponible', stock_sucursal: 0, stock_deposito: 0 };
    const precioLista = datos.precio_tarjeta !== 'No disponible' ? parseFloat(datos.precio_tarjeta) : null;
    const precioTexto = precioLista ? `$${precioLista.toLocaleString('es-AR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}` : 'Consultar precio';

    // Check if the product is in productosDestacados for 25% discount
    const isProductoDestacado = productosDestacados.includes(codigo);
    const precioConDescuento = isProductoDestacado && precioLista ? precioLista * 0.75 : null;
    const precioTextoConDescuento = precioConDescuento ? `$${precioConDescuento.toLocaleString('es-AR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}` : null;

    // Calculate price before national taxes (based on discounted price if applicable, otherwise original price)
    const precioBase = precioConDescuento || precioLista;
    const precioAnterior = precioBase ? precioBase / 1.21 : null;
    const precioAnteriorTexto = precioAnterior ? `$${precioAnterior.toLocaleString('es-AR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}` : 'Consultar precio';

    // Calculate installment prices based on original list price
    const cuotas = precioLista ? [
        { cuotas: 3, texto: '3 Cuotas sin interés', precio: (precioLista / 3) },
        { cuotas: 6, texto: '6 Cuotas sin interés', precio: (precioLista / 6) },
        { cuotas: 9, texto: '9 Cuotas sin interés', precio: (precioLista / 9) },
        { cuotas: 12, texto: '12 Cuotas sin interés', precio: (precioLista / 12) }
    ] : [];

    const sucursalTexto = datos.stock_sucursal > 0 ? datos.stock_sucursal + ' unidades' : 'Sin stock';
    const depositoTexto = datos.stock_deposito > 0 ? datos.stock_deposito + ' unidades' : 'Sin stock';

    document.getElementById('product-name').textContent = producto ? producto.nombre : 'Producto no encontrado';
    document.getElementById('product-description').innerHTML = descripcion.replace(/\n/g, '<br>');
    document.querySelector('.stock').textContent = '';

    // Insert product code
    const productName = document.getElementById('product-name');
    const codigoEl = document.createElement('p');
    codigoEl.className = 'product-code';
    codigoEl.textContent = 'Código: ' + codigo;
    productName.insertAdjacentElement('afterend', codigoEl);

    // Insert discount label for highlighted products
    if (isProductoDestacado) {
        const discountLabel = document.createElement('p');
        discountLabel.className = 'discount-label';
        discountLabel.textContent = '25% OFF CONTADO';
        codigoEl.insertAdjacentElement('afterend', discountLabel);
    }

    // Insert share button
    const shareButton = document.createElement('button');
    shareButton.className = 'share-btn';
    shareButton.title = 'Compartir producto';
    shareButton.innerHTML = `
        <img src="images/share-icon.png" alt="Compartir" class="icon-share-icon" style="vertical-align: middle;">`;
    codigoEl.insertAdjacentElement('afterend', shareButton);

    async function shortenUrl(longUrl) {
        const apiKey = '183d0cce9061cf282361fe75d4b4978ccea3dfdc';
        const response = await fetch(`https://api-ssl.bitly.com/v4/shorten`, {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${apiKey}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ long_url: longUrl })
        });
        const data = await response.json();
        return data.link;
    }

    shareButton.addEventListener('click', async () => {
        const shareData = {
            title: producto ? producto.nombre : 'Producto',
            text: `¡Mira este producto de Center Hogar Quilmes! ${producto ? producto.nombre : ''} (Código: ${codigo})\nPrecio: ${precioTexto}${isProductoDestacado ? `\nPrecio con descuento: ${precioTextoConDescuento}` : ''}\n`,
            url: await shortenUrl(window.location.href)
        };

        try {
            if (navigator.share) {
                await navigator.share(shareData);
            } else {
                const fallbackShare = document.createElement('div');
                fallbackShare.className = 'share-fallback';
                fallbackShare.innerHTML = `
                    <div class="share-fallback-content">
                        <h3>Compartir producto</h3>
                        <button onclick="window.open('https://api.whatsapp.com/send?text=${encodeURIComponent(shareData.text + shareData.url)}', '_blank')">Compartir por WhatsApp</button>
                        <button onclick="window.location.href='mailto:?subject=${encodeURIComponent(shareData.title)}&body=${encodeURIComponent(shareData.text + shareData.url)}'">Compartir por Email</button>
                        <button onclick="navigator.clipboard.writeText('${shareData.url}').then(() => alert('Enlace copiado al portapapeles'))">Copiar enlace</button>
                        <button onclick="this.parentElement.parentElement.remove()">Cerrar</button>
                    </div>
                `;
                document.body.appendChild(fallbackShare);
            }
        } catch (err) {
            console.error('Error al compartir:', err);
        }
    });

    const info = document.querySelector('.product-info');
    const before = document.querySelector('.shipping');

    // Create price container
    const preciosContainer = document.createElement('div');
    preciosContainer.className = 'precios-container';

    // Insert list price
    const precioEl = document.createElement('p');
    precioEl.className = `product-price ${isProductoDestacado ? 'original-price' : ''}`;
    precioEl.textContent = 'Precio de lista: ' + precioTexto;
    preciosContainer.appendChild(precioEl);

    // Insert discounted price if applicable
    if (isProductoDestacado && precioTextoConDescuento) {
        const precioDescuentoEl = document.createElement('p');
        precioDescuentoEl.className = 'product-price discount-price';
        precioDescuentoEl.textContent = 'Oferta de la semana: ' + precioTextoConDescuento;
        preciosContainer.appendChild(precioDescuentoEl);
    }

    // Insert price before taxes
    const precioAntEl = document.createElement('p');
    precioAntEl.className = 'product-price-anterior';
    precioAntEl.textContent = 'Pre.ant.imp.nac: ' + precioAnteriorTexto;
    preciosContainer.appendChild(precioAntEl);

    // Insert installment prices
    if (cuotas.length) {
        cuotas.forEach(cuota => {
            const cuotaEl = document.createElement('p');
            cuotaEl.className = `product-cuota product-cuota-${cuota.cuotas}`;
            let imgSrc, imgClass;
            if (cuota.cuotas === 3 || cuota.cuotas === 6 || cuota.cuotas === 9 || cuota.cuotas === 12) {
                imgSrc = 'images/tarjetas_de_credito_2.png';
                imgClass = 'cuota-card-icon';
            }
            cuotaEl.textContent = `${cuota.texto}: $${cuota.precio.toLocaleString('es-AR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            if (imgSrc) {
                const cuotaImg = document.createElement('img');
                cuotaImg.src = imgSrc;
                cuotaImg.alt = `Tarjetas para ${cuota.cuotas} cuotas`;
                cuotaImg.className = imgClass;
                cuotaEl.appendChild(cuotaImg);
            }
            preciosContainer.appendChild(cuotaEl);
        });
    }

    // Insert price container before shipping
    info.insertBefore(preciosContainer, before);

    // Insert stock
    const stockSucEl = document.createElement('p');
    stockSucEl.className = 'product-stock-sucursal';
    stockSucEl.textContent = 'Stock en sucursal: ' + sucursalTexto;
    info.insertBefore(stockSucEl, before);

    const stockDepEl = document.createElement('p');
    stockDepEl.className = 'product-stock-deposito';
    stockDepEl.textContent = 'Stock en depósito: ' + depositoTexto;
    info.insertBefore(stockDepEl, before);

    const mainImg = document.getElementById('main-image');
    if (imagenes.length) {
        mainImg.src = imagenes[0];
        mainImg.alt = producto ? producto.nombre : '';
    }
    const thumb = document.getElementById('thumbnail-gallery');
    thumb.innerHTML = '';
    imagenes.forEach((src, i) => {
        const img = document.createElement('img');
        img.src = src;
        img.alt = (producto ? producto.nombre : 'Imagen') + ' ' + (i + 1);
        img.className = i === 0 ? 'active' : '';
        img.onclick = () => mainImg.src = src;
        thumb.appendChild(img);
    });

    const feats = document.getElementById('product-features');
    feats.innerHTML = '';
    caracteristicas.forEach(f => {
        const li = document.createElement('li');
        li.textContent = f;
        feats.appendChild(li);
    });

    const wa = document.getElementById('whatsapp-consulta');
    const msg = `Hola, quiero un presupuesto al contado para ${producto ? producto.nombre : 'producto desconocido'} (Código ${codigo})${isProductoDestacado ? ' con 25% de descuento' : ''}.`;
    wa.href = `https://api.whatsapp.com/send?phone=5491131680489&text=${encodeURIComponent(msg)}`;
    const wat = document.getElementById('whatsapp-contado');
    const mssg = `Hola, quiero info acerca de ${producto ? producto.nombre : 'producto desconocido'} (Código ${codigo}).`;
    wat.href = `https://api.whatsapp.com/send?phone=5491131680489&text=${encodeURIComponent(mssg)}`;
});

// Scroll behavior for header
document.addEventListener('DOMContentLoaded', () => {
    if (document.body.classList.contains('product-page')) {
        let lastScrollTop = 0;
        const header = document.querySelector('.header');

        window.addEventListener('scroll', () => {
            let currentScroll = window.pageYOffset || document.documentElement.scrollTop;

            if (currentScroll > lastScrollTop && currentScroll > header.offsetHeight) {
                header.classList.add('hidden');
                header.classList.remove('show');
            } else if (currentScroll < lastScrollTop) {
                header.classList.remove('hidden');
                header.classList.add('show');
            }

            lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;
        });
    }
});

// Scroll behavior for header
document.addEventListener('DOMContentLoaded', () => {
    if (document.body.classList.contains('product-page')) {
        let lastScrollTop = 0;
        const header = document.querySelector('.header');

        window.addEventListener('scroll', () => {
            let currentScroll = window.pageYOffset || document.documentElement.scrollTop;

            if (currentScroll > lastScrollTop && currentScroll > header.offsetHeight) {
                header.classList.add('hidden');
                header.classList.remove('show');
            } else if (currentScroll < lastScrollTop) {
                header.classList.remove('hidden');
                header.classList.add('show');
            }

            lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;
        });
    }
});


document.addEventListener('DOMContentLoaded', () => {
    // Solo ejecutar si estamos en la página de producto
    if (document.body.classList.contains('product-page')) {
        let lastScrollTop = 0;
        const header = document.querySelector('.header');

        window.addEventListener('scroll', () => {
            let currentScroll = window.pageYOffset || document.documentElement.scrollTop;

            // Scroll hacia abajo: ocultar header parcialmente
            if (currentScroll > lastScrollTop && currentScroll > header.offsetHeight) {
                header.classList.add('hidden');
                header.classList.remove('show'); // Asegurar que no tenga la clase partial
            }
            // Scroll hacia arriba: mostrar header parcialmente
            else if (currentScroll < lastScrollTop) {
                header.classList.remove('hidden'); // Quitar clase hidden
                header.classList.add('show'); // Añadir clase partial
            }

            lastScrollTop = currentScroll <= 0 ? 0 : currentScroll; // Evitar valores negativos
        });
    }
});

    </script>
</body>
</html>
