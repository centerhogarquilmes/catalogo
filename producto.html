<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Producto - Center Hogar Quilmes</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" href="images/logo.webp" type="image/x-icon">
</head>
<body class="product-page-body">
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="index.html">
                        <img src="images/logo_trans.png" alt="Center Hogar Quilmes" class="logo-img">
                    </a>
                </div>
                <div class="header-actions">
                    <div class="user-options">
                        <a href="presupuesto.html" class="user-link" title="Pedir presupuesto" aria-label="Pedir presupuesto">
                            <span class="icon">üìù</span>
                            <span class="label">Pedir presupuesto</span>
                        </a>
                        <a href="contacto.html" class="cart-link" title="Contacto" aria-label="Contacto">
                            <span class="icon">üì±</span>
                            <span class="label">Contacto</span>
                        </a>
                    </div>
                    <button class="menu-toggle" aria-label="Abrir men√∫ de navegaci√≥n">‚ò∞</button>
                </div>
            </div>
            <div class="search-bar">
                <div class="search-bar-input-container">
                    <input type="text" placeholder="Buscar productos..." id="searchInput" autocomplete="off">
                    <button class="search-btn">
                        <img src="images/lupa.png" alt="Buscar" class="search-icon">
                    </button>
                </div>
                <div class="suggestions" id="suggestions" style="display: none;"></div>
            </div>
            <nav class="nav-menu" id="nav-menu">
    <ul>
        <li><a href="categoria.html?nombre=Cocinas">Cocinas</a></li>
        <li><a href="categoria.html?nombre=Heladeras">Heladeras</a></li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Tv y audio">Tv y Audio</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Tv y audio&subcategoria=Tv">Tv</a></li>
                <li><a href="categoria.html?nombre=Tv y audio&subcategoria=Audio">Audio</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Tecnologia">Tecnolog√≠a</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Tecnologia&subcategoria=Celulares">Celulares</a></li>
                <li><a href="categoria.html?nombre=Tecnologia&subcategoria=Notebooks">Notebooks</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Climatizacion">Climatizaci√≥n</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Calefaccion electrica">Calefacci√≥n el√©ctrica</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Calefaccion a gas">Calefacci√≥n a gas</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Ventilacion">Ventilaci√≥n</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Aires acondicionados">Aires Acondicionados</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Hornos, microondas y freidoras">Hornos, microondas y freidoras</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Hornos">Hornos</a></li>
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Microondas">Microondas</a></li>
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Freidoras">Freidoras</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Lavado">Lavado</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Lavarropas">Lavarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Lavasecarropas">Lavasecarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Secarropas">Secarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Planchas">Planchas</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Termotanques">Termotanques</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Termotanques&subcategoria=Gas">Gas</a></li>
                <li><a href="categoria.html?nombre=Termotanques&subcategoria=El√©ctrico">El√©ctrico</a></li>
                <li><a href="categoria.html?nombre=Termotanques&subcategoria=Dual">Dual</a></li>
            </ul>
        </li><li class="has-submenu">
            <a href="categoria.html?nombre=Peque√±os electrodomesticos">Peque√±os</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Batidoras">Batidoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Licuadoras">Licuadoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Multiprocesadoras">Multiprocesadoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Mixers">Mixers</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Pavas electricas">Pavas El√©ctricas</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Cafeteras">Cafeteras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Tostadoras">Tostadoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Sandwicheras">Sandwicheras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subCategoria=Exprimidores y jugueras">Exprimidores y Jugueras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Picadoras">Picadoras</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Cuidado personal">Cuidado Personal</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Planchas de pelo">Planchas de Pelo</a></li>
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Secadores de pelo">Secadores de Pelo</a></li>
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Cortadoras de pelo y barba">Cortadoras de Pelo y Barba</a></li>
            </ul>
        </li>
    </ul>
</nav>
        </div>
    </header>

    <!-- Product Details -->
    <main class="container product-page">
        <!-- Modal para ampliaci√≥n de im√°genes -->
        <div class="image-modal" id="image-modal" style="display: none;">
            <span class="modal-close">√ó</span>
            <div class="modal-content">
                <img id="modal-image" src="" alt="Producto ampliado">
            </div>
            <button class="modal-btn prev">‚ùÆ</button>
            <button class="modal-btn next">‚ùØ</button>
        </div>
        <div class="product-main">
            <div class="image-container">
                <div class="product-images">
                    <div class="main-image-wrapper">
                        <img id="main-image" src="" alt="Producto" class="main-image">
                        <button class="carousel-btn prev">‚ùÆ</button>
                        <button class="carousel-btn next">‚ùØ</button>
                    </div>
                    <div class="thumbnail-gallery" id="thumbnail-gallery">
                        <!-- Thumbnails se llenan con JavaScript -->
                    </div>
                </div>
            </div>
            <div class="info-container">
                <div class="product-info">
                    <h1 id="product-name">Nombre del producto</h1>
                    <p class="stock">Stock disponible</p>
                    <a id="whatsapp-btn" href="#" class="buy-btn" target="_blank">Consultar</a>
                    <div class="shipping">
                        <p>Consult√° costos de envio</p>
                        <p>Normalmente se entrega de un dia para el otro</p>
                    </div>
                    <!-- Descripci√≥n movida aqu√≠ -->
                    <div class="product-description">
                        <h2>Descripci√≥n</h2>
                        <p id="product-description">Descripci√≥n del producto.</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- Caracter√≠sticas movidas aqu√≠ -->
        <div class="product-features">
            <h2>Caracter√≠sticas del producto</h2>
            <ul id="product-features">
                <!-- Se llenan con JavaScript -->
            </ul>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>¬© 2025 Center Hogar Quilmes. Todos los derechos reservados.</p>
            <ul>
                <li><a href="terminos.html">T√©rminos y condiciones</a></li>
                <li><a href="contacto.html">Contacto</a></li>
                <li><a href="privacidad.html">Privacidad</a></li>
            </ul>
        </div>
    </footer>

    <!-- Bot√≥n flotante para volver arriba -->
    <button class="scroll-to-top" title="Volver arriba">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 19V5"></path>
            <path d="M5 12l7-7 7 7"></path>
        </svg>
    </button>

<script src="precios.js"></script>
<script src="productos.js"></script>
<script src="scripts.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    // Leer par√°metros de la URL con manejo seguro
    const urlParams = new URLSearchParams(window.location.search);
    const nombre = urlParams.get('nombre') ? decodeURIComponent(urlParams.get('nombre')) : 'Producto';
    const imagen = urlParams.get('imagen') ? decodeURIComponent(urlParams.get('imagen')) : 'images/nomedia.jpg';
    const imagenes = urlParams.get('imagenes') ? decodeURIComponent(urlParams.get('imagenes')).split(',').filter(img => img) : [imagen];
    const descripcion = urlParams.get('descripcion') ? decodeURIComponent(urlParams.get('descripcion')) : 'Descripci√≥n del producto.';
    const caracteristicas = urlParams.get('caracteristicas') ? decodeURIComponent(urlParams.get('caracteristicas')).split(',').filter(c => c) : ['Marca: [Marca]', 'Modelo: [Modelo]', 'Garant√≠a: 1 a√±o'];

    // Buscar el producto en productos.js con manejo de errores
    const producto = productos && Array.isArray(productos) ? productos.find(p => p.nombre === nombre) : null;
    const codigoProducto = producto ? producto.codigo : 0;

    // Obtener datos din√°micos de precios.js
    const datosDinamicos = precios && precios[codigoProducto] ? precios[codigoProducto] : { stock: 0, precio_tarjeta: 'No disponible' };
    const stockTexto = datosDinamicos.stock > 0 ? `Stock disponible: ${datosDinamicos.stock} unidades` : 'Sin stock';
    const precioTexto = datosDinamicos.precio_tarjeta !== 'No disponible' ? `$${parseFloat(datosDinamicos.precio_tarjeta).toLocaleString('es-AR')}` : 'Precio no disponible';

    // Actualizar contenido
    const productName = document.getElementById('product-name');
    const mainImage = document.getElementById('main-image');
    const productDescription = document.getElementById('product-description');
    if (productName) productName.innerHTML = nombre;
    if (mainImage) {
        mainImage.src = imagen;
        mainImage.alt = nombre;
        mainImage.onerror = function () {
            this.onerror = null;
            this.src = 'images/nomedia.jpg';
        };
    }
    if (productDescription) productDescription.innerHTML = descripcion.replace(/\n/g, '<br>'); // Renderizar saltos de l√≠nea como <br>

    // Mostrar stock y c√≥digo
    const stockElement = document.querySelector('.stock');
    if (stockElement) stockElement.innerHTML = `${stockTexto} | C√≥digo: ${codigoProducto}`;

    // Agregar precio al DOM
    const productInfo = document.querySelector('.product-info');
    const shipping = document.querySelector('.shipping');
    if (productInfo && shipping) {
        const precioElement = document.createElement('p');
        precioElement.className = 'product-price';
        precioElement.innerHTML = `Precio de lista: ${precioTexto}`;
        productInfo.insertBefore(precioElement, shipping);
    }

    // Generar thumbnails
    const thumbnailGallery = document.getElementById('thumbnail-gallery');
    if (thumbnailGallery) {
        imagenes.forEach((img, index) => {
            const thumbnail = document.createElement('img');
            thumbnail.src = img;
            thumbnail.alt = `${nombre} - Imagen ${index + 1}`;
            thumbnail.onerror = function () {
                console.error(`Error al cargar la imagen de la miniatura: ${img}`);
                this.onerror = null;
                this.src = 'images/nomedia.jpg';
            };
            thumbnail.onclick = () => showImage(index);
            if (index === 0) thumbnail.classList.add('active');
            thumbnailGallery.appendChild(thumbnail);
        });
    }

    // Generar caracter√≠sticas
    const featuresList = document.getElementById('product-features');
    if (featuresList) {
        featuresList.innerHTML = '';
        caracteristicas.forEach(feature => {
            const li = document.createElement('li');
            li.textContent = feature;
            featuresList.appendChild(li);
        });
    }

    // Bot√≥n de WhatsApp
    const whatsappBtn = document.getElementById('whatsapp-btn');
    if (whatsappBtn) {
        const numeroWhatsApp = '5491131680489';
        const mensaje = `Hola, quiero un presupuesto para ${nombre}.`;
        whatsappBtn.href = `https://api.whatsapp.com/send?phone=${encodeURIComponent(numeroWhatsApp)}&text=${encodeURIComponent(mensaje)}`;
    }

    // Navegaci√≥n de im√°genes
    let currentImageIndex = 0;
    const prevBtn = document.querySelector('.main-image-wrapper .carousel-btn.prev');
    const nextBtn = document.querySelector('.main-image-wrapper .carousel-btn.next');

    function showImage(index) {
        if (index >= imagenes.length) {
            currentImageIndex = 0;
        } else if (index < 0) {
            currentImageIndex = imagenes.length - 1;
        } else {
            currentImageIndex = index;
        }
        console.log(`Cambiando a imagen ${currentImageIndex}: ${imagenes[currentImageIndex]}`);
        if (mainImage) mainImage.src = imagenes[currentImageIndex];

        // Actualizar el thumbnail activo
        const thumbnails = thumbnailGallery ? thumbnailGallery.querySelectorAll('img') : [];
        thumbnails.forEach((thumb, i) => {
            thumb.classList.toggle('active', i === currentImageIndex);
        });
    }

    // Configurar botones de navegaci√≥n
    if (prevBtn && nextBtn) {
        if (imagenes.length > 1 && window.innerWidth > 768) {
            prevBtn.style.display = 'flex';
            nextBtn.style.display = 'flex';
        } else {
            prevBtn.style.display = 'none';
            nextBtn.style.display = 'none';
        }

        prevBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            console.log('Clic en el bot√≥n prev');
            showImage(currentImageIndex - 1);
        });

        nextBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            console.log('Clic en el bot√≥n next');
            showImage(currentImageIndex + 1);
        });

        window.addEventListener('resize', () => {
            if (imagenes.length > 1 && window.innerWidth > 768) {
                prevBtn.style.display = 'flex';
                nextBtn.style.display = 'flex';
            } else {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
            }
        });
    }

    // Modal
    const modal = document.getElementById('image-modal');
    const modalImage = document.getElementById('modal-image');
    const modalCloseModal = document.querySelector('.modal-close');
    const modalPrev = document.querySelector('.modal-btn.prev');
    const modalNext = document.querySelector('.modal-btn.next');

    if (!modal || !modalImage || !modalCloseModal || !modalPrev || !modalNext) {
        console.error('Elementos del modal no encontrados');
        return;
    }

    if (mainImage) {
        mainImage.addEventListener('click', (e) => {
            if (window.innerWidth > 768) {
                e.stopPropagation();
                console.log('Clic en la imagen principal');
                modalImage.src = mainImage.src;
                modal.classList.add('active');
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden'; // Corregir 'background' por 'overflow'
            }
        });

        mainImage.addEventListener('touchend', (e) => {
            if (window.innerWidth <= 768) {
                e.preventDefault();
                console.log('Toque en la imagen principal');
                modalImage.src = mainImage.src;
                modal.classList.add('active');
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
        });
    }

    modalCloseModal.addEventListener('click', () => {
        console.log('Clic en cerrar el modal');
        modal.classList.remove('active');
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    });

    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            console.log('Clic fuera del modal');
            modal.classList.remove('active');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
    });

    modalPrev.addEventListener('click', () => {
        console.log('Clic en modal prev');
        showImage(currentImageIndex - 1);
        modalImage.src = imagenes[currentImageIndex];
    });

    modalNext.addEventListener('click', () => {
        console.log('Clic en modal next');
        showImage(currentImageIndex + 1);
        modalImage.src = imagenes[currentImageIndex];
    });

    document.addEventListener('keydown', (e) => {
        if (modal.classList.contains('active')) {
            if (e.key === 'ArrowLeft') {
                console.log('Tecla izquierda en el modal');
                showImage(currentImageIndex - 1);
                modalImage.src = imagenes[currentImageIndex];
            } else if (e.key === 'ArrowRight') {
                console.log('Tecla derecha en el modal');
                showImage(currentImageIndex + 1);
                modalImage.src = imagenes[currentImageIndex];
            } else if (e.key === 'Escape') {
                console.log('Tecla Escape en el modal');
                modal.classList.remove('active');
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }
    });
});
</script>
</body>
</html>