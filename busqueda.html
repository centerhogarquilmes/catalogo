<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√∫squeda - Center Hogar Quilmes</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" href="images/logo.webp" type="image/x-icon">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="index.html">
                        <img src="images/logo_trans.png" alt="Center Hogar Quilmes" class="logo-img">
                    </a>
                </div>
                <div class="header-actions">
                    <div class="user-options">
                        <a href="presupuesto.html" class="user-link" title="Pedir presupuesto" aria-label="Pedir presupuesto">
                            <span class="icon">üìù</span>
                            <span class="label">Pedir presupuesto</span>
                        </a>
                        <a href="contacto.html" class="cart-link" title="Contacto" aria-label="Contacto">
                            <span class="icon">üì±</span>
                            <span class="label">Contacto</span>
                        </a>
                    </div>
                    <button class="menu-toggle" aria-label="Abrir men√∫ de navegaci√≥n">‚ò∞</button>
                </div>
            </div>
            <div class="search-bar">
                <div class="search-bar-input-container">
                    <input type="text" placeholder="Buscar productos..." id="searchInput" autocomplete="off">
                    <button class="search-btn">
                        <img src="images/lupa.png" alt="Buscar" class="search-icon">
                    </button>
                </div>
                <div class="suggestions" id="suggestions" style="display: none;"></div>
            </div>
            <nav class="nav-menu" id="nav-menu">
    <ul>
        <li><a href="categoria.html?nombre=Cocinas">Cocinas</a></li>
        <li><a href="categoria.html?nombre=Heladeras">Heladeras</a></li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Tv y audio">Tv y Audio</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Tv y audio&subcategoria=Tv">Tv</a></li>
                <li><a href="categoria.html?nombre=Tv y audio&subcategoria=Audio">Audio</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Tecnologia">Tecnolog√≠a</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Tecnologia&subcategoria=Celulares">Celulares</a></li>
                <li><a href="categoria.html?nombre=Tecnologia&subcategoria=Notebooks">Notebooks</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Climatizacion">Climatizaci√≥n</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Calefaccion electica">Calefacci√≥n el√©ctrica</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Calefaccion a gas">Calefacci√≥n a gas</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Ventilacion">Ventilaci√≥n</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Aires acondicionados">Aires Acondicionados</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Hornos, microondas y freidoras">Hornos, microondas y freidoras</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Hornos">Hornos</a></li>
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Microondas">Microondas</a></li>
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Freidoras">Freidoras</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Lavado">Lavado</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Lavarropas">Lavarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Lavasecarropas">Lavasecarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Secarropas">Secarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Planchas">Planchas</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Termotanques">Termotanques</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Termotanques&subcategoria=Gas">Gas</a></li>
                <li><a href="categoria.html?nombre=Termotanques&subcategoria=El√©ctrico">El√©ctrico</a></li>
                <li><a href="categoria.html?nombre=Termotanques&subcategoria=Dual">Dual</a></li>
            </ul>
        </li><li class="has-submenu">
            <a href="categoria.html?nombre=Peque√±os electrodomesticos">Peque√±os</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Batidoras">Batidoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Licuadoras">Licuadoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Multiprocesadoras">Multiprocesadoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Mixers">Mixers</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Pavas electricas">Pavas El√©ctricas</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Cafeteras">Cafeteras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Tostadoras">Tostadoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Sandwicheras">Sandwicheras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subCategoria=Exprimidores y jugueras">Exprimidores y Jugueras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Picadoras">Picadoras</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Cuidado personal">Cuidado Personal</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Planchas de pelo">Planchas de Pelo</a></li>
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Secadores de pelo">Secadores de Pelo</a></li>
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Cortadoras de pelo y barba">Cortadoras de Pelo y Barba</a></li>
            </ul>
        </li>
    </ul>
</nav><nav class="nav-menu" id="nav-menu">
    <ul>
        <li><a href="categoria.html?nombre=Cocinas">Cocinas</a></li>
        <li><a href="categoria.html?nombre=Heladeras">Heladeras</a></li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Tv y audio">Tv y Audio</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Tv y audio&subcategoria=Tv">Tv</a></li>
                <li><a href="categoria.html?nombre=Tv y audio&subcategoria=Audio">Audio</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Tecnologia">Tecnolog√≠a</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Tecnologia&subcategoria=Celulares">Celulares</a></li>
                <li><a href="categoria.html?nombre=Tecnologia&subcategoria=Notebooks">Notebooks</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Climatizacion">Climatizaci√≥n</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Calefaccion electrica">Calefacci√≥n el√©ctrica</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Calefaccion a gas">Calefacci√≥n a gas</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Ventilacion">Ventilaci√≥n</a></li>
                <li><a href="categoria.html?nombre=Climatizacion&subcategoria=Aires acondicionados">Aires Acondicionados</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Hornos, microondas y freidoras">Hornos, microondas y freidoras</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Hornos">Hornos</a></li>
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Microondas">Microondas</a></li>
                <li><a href="categoria.html?nombre=Hornos, microondas y freidoras&subcategoria=Freidoras">Freidoras</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Lavado">Lavado</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Lavarropas">Lavarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Lavasecarropas">Lavasecarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Secarropas">Secarropas</a></li>
                <li><a href="categoria.html?nombre=Lavado&subcategoria=Planchas">Planchas</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Termotanques">Termotanques</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Termotanques&subcategoria=Gas">Gas</a></li>
                <li><a href="categoria.html?nombre=Termotanques&subcategoria=El√©ctrico">El√©ctrico</a></li>
                <li><a href="categoria.html?nombre=Termotanques&subcategoria=Dual">Dual</a></li>
            </ul>
        </li><li class="has-submenu">
            <a href="categoria.html?nombre=Peque√±os electrodomesticos">Peque√±os</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Batidoras">Batidoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Licuadoras">Licuadoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Multiprocesadoras">Multiprocesadoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Mixers">Mixers</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Pavas electricas">Pavas El√©ctricas</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Cafeteras">Cafeteras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Tostadoras">Tostadoras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Sandwicheras">Sandwicheras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subCategoria=Exprimidores y jugueras">Exprimidores y Jugueras</a></li>
                <li><a href="categoria.html?nombre=Peque√±os electrodomesticos&subcategoria=Picadoras">Picadoras</a></li>
            </ul>
        </li>
        <li class="has-submenu">
            <a href="categoria.html?nombre=Cuidado personal">Cuidado Personal</a>
            <ul class="submenu">
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Planchas de pelo">Planchas de Pelo</a></li>
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Secadores de pelo">Secadores de Pelo</a></li>
                <li><a href="categoria.html?nombre=Cuidado personal&subcategoria=Cortadoras de pelo y barba">Cortadoras de Pelo y Barba</a></li>
            </ul>
        </li>
    </ul>
</nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
    <section class="catalog">
        <h2 id="search-title">Resultados de b√∫squeda</h2>
        <div class="view-toggle" id="view-toggle">
            <button class="view-btn grid-view active" data-view="grid" title="Vista en mosaico" aria-label="Vista en mosaico">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                </svg>
            </button>
            <button class="view-btn list-view" data-view="list" title="Vista en lista" aria-label="Vista en lista">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
        </div>
        <div class="product-grid" id="product-grid">
            <!-- Productos se llenan con JavaScript -->
        </div>
    </section>
</main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>¬© 2025 Center Hogar Quilmes. Todos los derechos reservados.</p>
            <ul>
                <li><a href="terminos.html">T√©rminos y condiciones</a></li>
                <li><a href="contacto.html">Contacto</a></li>
                <li><a href="privacidad.html">Privacidad</a></li>
            </ul>
        </div>
    </footer>

    <!-- Bot√≥n flotante para volver arriba -->
    <button class="scroll-to-top" title="Volver arriba">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 19V5"></path>
            <path d="M5 12l7-7 7 7"></path>
        </svg>
    </button>

    <!-- Scripts -->
    <script src="productos.js"></script>
    <script src="scripts.js"></script>
    <script>
    // Normalizar texto para manejar acentos
    function normalizeString(input) {
        if (Array.isArray(input)) {
            input = input.join(' ');
        }
        if (typeof input !== 'string') {
            input = String(input || '');
        }
        return input.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
    }

    // Funci√≥n para dividir el t√©rmino de b√∫squeda en palabras clave
    function getSearchKeywords(query) {
        return query.trim().split(/\s+/).map(keyword => normalizeString(keyword)).filter(keyword => keyword.length > 0);
    }

    // Funci√≥n para verificar si un producto coincide con todas las palabras clave
    function matchesKeywords(producto, keywords) {
        const fields = [
            normalizeString(producto.nombre),
            normalizeString(producto.categoria),
            normalizeString(producto.codigo || ''),
            normalizeString(producto.descripcion),
            normalizeString(producto.caracteristicas)
        ].join(' ');

        return keywords.every(keyword => fields.includes(keyword));
    }

    // Obtener el t√©rmino de b√∫squeda desde la URL
    const urlParams = new URLSearchParams(window.location.search);
    const query = urlParams.get('query') || '';
    document.getElementById('search-title').textContent = query ? `Resultados de b√∫squeda para "${query}"` : 'Resultados de b√∫squeda';
    document.getElementById('searchInput').value = query;

    // Filtrar productos por todas las palabras clave
    const keywords = getSearchKeywords(query);
    const productosFiltrados = productos.filter(producto => matchesKeywords(producto, keywords));

    // Generar las tarjetas de productos
    const productGrid = document.getElementById('product-grid');
    productGrid.innerHTML = ''; // Limpiar el grid antes de agregar productos
    if (productosFiltrados.length === 0) {
        productGrid.innerHTML = '<p>No se encontraron productos para la b√∫squeda.</p>';
    } else {
        productosFiltrados.forEach(producto => {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.innerHTML = `
                <a href="producto.html?nombre=${encodeURIComponent(producto.nombre)}&categoria=${encodeURIComponent(producto.categoria)}&subcategoria=${encodeURIComponent(producto.subcategoria || '')}&imagen=${encodeURIComponent(producto.imagen)}&imagenes=${producto.imagenes.map(img => encodeURIComponent(img)).join(',')}&descripcion=${encodeURIComponent(producto.descripcion)}&caracteristicas=${producto.caracteristicas.map(c => encodeURIComponent(c)).join(',')}">
                    <img src="${producto.imagen}" alt="${producto.nombre}" onerror="this.onerror=null; this.src='images/nomedia_trans.png';">
                    <div class="text-container">
                        <h3>${producto.nombre}</h3>
                        <p class="product-code">C√≥digo: ${producto.codigo}</p>
                        <button class="buy-btn">Ver m√°s</button>
                    </div>
                </a>
            `;
            productGrid.appendChild(card);
        });
    }

    // Alternancia entre vistas
    const gridBtn = document.querySelector('.view-btn.grid-view');
    const listBtn = document.querySelector('.view-btn.list-view');

    if (productGrid && gridBtn && listBtn) {
        // Asegurar vista mosaico por defecto
        productGrid.classList.remove('list-view');
        gridBtn.classList.add('active');
        listBtn.classList.remove('active');
        console.log('Vista inicial: mosaico');

        gridBtn.addEventListener('click', () => {
            productGrid.classList.remove('list-view');
            gridBtn.classList.add('active');
            listBtn.classList.remove('active');
            console.log('Vista cambiada a: mosaico');
        });

        listBtn.addEventListener('click', () => {
            productGrid.classList.add('list-view');
            listBtn.classList.add('active');
            gridBtn.classList.remove('active');
            console.log('Vista cambiada a: lista');
        });
    } else {
        console.error('Error: No se encontraron productGrid, gridBtn o listBtn');
    }

    // Configurar la barra de b√∫squeda y sugerencias
    const searchInput = document.getElementById('searchInput');
    const suggestionsContainer = document.getElementById('suggestions');
    let selectedIndex = -1;

    searchInput.addEventListener('input', () => {
        const query = searchInput.value.trim();
        const keywords = getSearchKeywords(query);
        suggestionsContainer.innerHTML = '';
        selectedIndex = -1;

        if (keywords.length === 0) {
            suggestionsContainer.style.display = 'none';
            searchInput.style.borderBottomLeftRadius = '4px';
            return;
        }

        // Filtrar sugerencias por todas las palabras clave
        const filteredSuggestions = productos.filter(producto => matchesKeywords(producto, keywords));

        if (filteredSuggestions.length === 0) {
            suggestionsContainer.style.display = 'none';
            searchInput.style.borderBottomLeftRadius = '4px';
            return;
        }

        // Mostrar hasta 5 sugerencias
        filteredSuggestions.slice(0, 5).forEach((producto, index) => {
            const suggestionDiv = document.createElement('div');
            suggestionDiv.textContent = producto.nombre;
            suggestionDiv.setAttribute('data-index', index);
            suggestionDiv.addEventListener('click', () => {
                searchInput.value = producto.nombre;
                suggestionsContainer.style.display = 'none';
                searchInput.style.borderBottomLeftRadius = '4px';
                window.location.href = `producto.html?nombre=${encodeURIComponent(producto.nombre)}&categoria=${encodeURIComponent(producto.categoria)}&subcategoria=${encodeURIComponent(producto.subcategoria || '')}&imagen=${encodeURIComponent(producto.imagen)}&imagenes=${producto.imagenes.map(img => encodeURIComponent(img)).join(',')}&descripcion=${encodeURIComponent(producto.descripcion)}&caracteristicas=${producto.caracteristicas.map(c => encodeURIComponent(c)).join(',')}`;
            });
            suggestionsContainer.appendChild(suggestionDiv);
        });

        suggestionsContainer.style.display = 'block';
        searchInput.style.borderBottomLeftRadius = '0';
    });

    searchInput.addEventListener('keydown', (e) => {
        const suggestionItems = suggestionsContainer.querySelectorAll('div');
        if (suggestionItems.length === 0) return;

        if (e.key === 'ArrowDown') {
            e.preventDefault();
            selectedIndex = Math.min(selectedIndex + 1, suggestionItems.length - 1);
            updateSelection();
        } else if (e.key === 'ArrowUp') {
            e.preventDefault();
            selectedIndex = Math.max(selectedIndex - 1, -1);
            updateSelection();
        } else if (e.key === 'Enter' && selectedIndex >= 0) {
            e.preventDefault();
            const selectedSuggestion = suggestionItems[selectedIndex].textContent;
            searchInput.value = selectedSuggestion;
            suggestionsContainer.style.display = 'none';
            searchInput.style.borderBottomLeftRadius = '4px';
            const producto = productos.find(p => p.nombre === selectedSuggestion);
            if (producto) {
                window.location.href = `producto.html?nombre=${encodeURIComponent(producto.nombre)}&categoria=${encodeURIComponent(producto.categoria)}&subcategoria=${encodeURIComponent(producto.subcategoria || '')}&imagen=${encodeURIComponent(producto.imagen)}&imagenes=${producto.imagenes.map(img => encodeURIComponent(img)).join(',')}&descripcion=${encodeURIComponent(producto.descripcion)}&caracteristicas=${producto.caracteristicas.map(c => encodeURIComponent(c)).join(',')}`;
            }
        } else if (e.key === 'Enter') {
            const query = searchInput.value.trim();
            if (query) {
                window.location.href = `busqueda.html?query=${encodeURIComponent(query)}`;
            }
        }
    });

    function updateSelection() {
        const suggestionItems = suggestionsContainer.querySelectorAll('div');
        suggestionItems.forEach((item, index) => {
            item.classList.toggle('selected', index === selectedIndex);
        });
        if (selectedIndex >= 0) {
            suggestionItems[selectedIndex].scrollIntoView({ block: 'nearest' });
        }
    }

    // Cerrar sugerencias al hacer clic fuera
    document.addEventListener('click', (e) => {
        if (!searchInput.contains(e.target) && !suggestionsContainer.contains(e.target)) {
            suggestionsContainer.style.display = 'none';
            searchInput.style.borderBottomLeftRadius = '4px';
            selectedIndex = -1;
        }
    });

    // Redirigir al hacer clic en el bot√≥n de b√∫squeda
    document.querySelector('.search-btn').addEventListener('click', () => {
        const query = searchInput.value.trim();
        if (query) {
            window.location.href = `busqueda.html?query=${encodeURIComponent(query)}`;
        }
    });
</script>
</body>
</html>